<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<title>Christmas Gift Hunt 2025</title>
<meta name="viewport" content="width=device-width,initial-scale=1.0,maximum-scale=1.0,user-scalable=no">
<style>
  body{margin:0;overflow:hidden;background:#000;font-family:'Segoe UI',sans-serif}
  canvas{display:block}
  #ui{position:absolute;inset:0;pointer-events:none;color:#fff;font-size:24px;text-shadow:0 0 8px #000}
  #timer,#gifts{position:absolute;top:10px;padding:10px 15px;background:rgba(0,0,0,0.6);border-radius:12px}
  #timer{right:10px}
  #gifts{left:10px}
  #levelName{position:absolute;bottom:15px;left:50%;transform:translateX(-50%);background:rgba(0,0,0,0.7);padding:8px 25px;border-radius:20px;font-size:28px}
  #start,#gameOver,#levelSelect{position:absolute;inset:0;background:rgba(0,0,0,0.95);color:#fff;display:flex;flex-direction:column;justify-content:center;align-items:center;text-align:center}
  button{margin:15px;padding:16px 40px;font-size:26px;background:#c00;border:none;border-radius:16px;color:#fff;cursor:pointer;box-shadow:0 8px 0 #900}
  button:active{transform:translateY(4px);box-shadow:0 4px 0 #900}
  .card{background:linear-gradient(135deg,#c00,#e00);padding:25px;margin:10px;border-radius:20px;color:#fff;box-shadow:0 10px 0 #900;cursor:pointer;min-width:160px}
  .card.locked{opacity:0.4}
</style>
</head>
<body>

<canvas id="c"></canvas>
<img id="bgImg" style="display:none">

<div id="ui">
  <div id="timer"></div>
  <div id="gifts"></div>
  <div id="levelName"></div>
</div>

<div id="start">
  <h1 style="font-size:48px;margin:20px">Christmas Gift Hunt 2025</h1>
  <p style="font-size:28px">Find 20 hidden gifts fast!<br>Beware the sneaky Grinch!</p>
  <button id="playBtn">PLAY</button>
</div>

<div id="levelSelect" style="display:none"></div>

<div id="gameOver" style="display:none">
  <h1 id="result" style="font-size:44px"></h1>
  <p id="scoreText" style="font-size:32px"></p>
  <button onclick="shareResult()">Share Score</button>
  <button onclick="showLevelSelect()">Levels</button>
  <button onclick="location.reload()">Play Again</button>
</div>

<audio id="music" loop></audio>

<script>
// LEVELS — beautiful photos + real music + hard timers + Levels 9–10 unlocked
const levels = [
  {name:"Cozy Living Room",      time:45, grinches:0,  bg:"https://images.unsplash.com/photo-1606982230228-9b3c3a8cb3ee?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_69d9e1d8c5.mp3?filename=jingle-bells-12279.mp3"},
  {name:"Snowy Village Night",   time:42, grinches:0,  bg:"https://images.unsplash.com/photo-1543585078-0c6e9b1fe7e8?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_fa7d8f8e4a.mp3?filename=we-wish-you-a-merry-christmas-18895.mp3"},
  {name:"Santa's Workshop",      time:40, grinches:3,  bg:"https://images.unsplash.com/photo-1606993899933-96ef103b4f1?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_2e8d9f7a9c.mp3?filename=christmas-workshop-17893.mp3"},
  {name:"Gingerbread House",     time:38, grinches:5,  bg:"https://images.unsplash.com/photo-1606983340126-99d0c2021d38?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_8c7d6f5e4d.mp3?filename=gingerbread-christmas-18342.mp3"},
  {name:"Australian Beach Xmas", time:36, grinches:7,  bg:"https://images.unsplash.com/photo-1519748779661-9c8f2c1f2924?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_1a2b3c4d5e.mp3?filename=aussie-christmas-18401.mp3"},
  {name:"Enchanted Forest",      time:34, grinches:10, bg:"https://images.unsplash.com/photo-1543599430-7bf5e2c8e7c9?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_9f8e7d6c5b.mp3?filename=winter-forest-17894.mp3"},
  {name:"North Pole Blizzard",   time:32, grinches:14, bg:"https://images.unsplash.com/photo-1517694719679-0ce2d2c8e8e6?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_4d3c2b1a0.mp3?filename=blizzard-bells-18321.mp3"},
  {name:"Grinch's Lair",         time:30, grinches:20, bg:"https://images.unsplash.com/photo-1606921236453-5d25a38e94c9?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_5e4d3c2b1a.mp3?filename=grinch-theme-18333.mp3"},
  {name:"Hawaiian Christmas",    time:28, grinches:28, bg:"https://images.unsplash.com/photo-1543589624-5d4d44e1a2d5?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_6f5e4d3c2b.mp3?filename=melele-kalikimaka-18322.mp3"},
  {name:"Rooftop Rush",          time:25, grinches:40, bg:"https://images.unsplash.com/photo-1489009154095-7d3c6c3d3d3d?w=1200&auto=format&fit=crop", music:"https://cdn.pixabay.com/download/audio/2024/11/26/audio_7g6f5e4d3c.mp3?filename=rooftop-rush-18344.mp3"}
];

const giftImg = new Image();   giftImg.src = "https://i.ibb.co/5Yb5K3K/gift.png";
const grinchImg = new Image(); grinchImg.src = "https://i.ibb.co/7pZ7Z7Z/grinch-small.png";

let c = document.getElementById("c");
let ctx = c.getContext("2d");
let bgImg = document.getElementById("bgImg");
let music = document.getElementById("music");
let currentLevel = 0, giftsFound = 0, timeLeft = 0, objects = [];
let unlocked = +localStorage.getItem("xmas2025")||0;

function resize(){c.width=innerWidth;c.height=innerHeight}
window.onresize=resize; resize();

class Item{
  constructor(isGrinch=false){
    this.isGrinch=isGrinch;
    this.x=80+Math.random()*(c.width-160);
    this.y=80+Math.random()*(c.height-160);
    this.size=isGrinch?70:60;
    this.alpha=0.92+Math.random()*0.07; // very hard to spot
  }
  draw(){
    ctx.globalAlpha = this.alpha;
    ctx.drawImage(this.isGrinch?grinchImg:giftImg, this.x-this.size/2, this.y-this.size/2, this.size, this.size);
    ctx.globalAlpha = 1;
  }
}

function spawn(){
  objects=[];
  for(let i=0;i<20;i++) objects.push(new Item(false));
  for(let i=0;i<levels[currentLevel].grinches;i++) objects.push(new Item(true));
}

function draw(){
  ctx.drawImage(bgImg,0,0,c.width,c.height);
  objects.forEach(o=>o.draw());
  document.getElementById("timer").textContent=`Time: ${Math.ceil(timeLeft)}s`;
  document.getElementById("gifts").textContent=`Gifts: ${giftsFound}/20`;
  document.getElementById("levelName").textContent=levels[currentLevel].name;
}

function loop(){
  timeLeft-=1/60;
  if(timeLeft<=0) gameOver(false);
  draw();
  requestAnimationFrame(loop);
}

c.onclick=c.ontouchstart=e=>{
  e.preventDefault();
  let r=c.getBoundingClientRect();
  let x=(e.touches?e.touches[0].clientX:e.clientX)-r.left;
  let y=(e.touches?e.touches[0].clientY:e.clientY)-r.top;
  for(let i=objects.length-1;i>=0;i--){
    let o=objects[i];
    if(Math.hypot(o.x-x,o.y-y)<o.size/2){
      if(o.isGrinch){
        giftsFound=0;
        spawn(); // respawn everything
        ctx.fillStyle="rgba(200,0,0,0.6)"; ctx.fillRect(0,0,c.width,c.height);
      }else{
        giftsFound++;
        objects.splice(i,1);
        if(giftsFound>=20) gameOver(true);
      }
      break;
    }
  }
};

function startLevel(i){
  currentLevel=i; giftsFound=0; timeLeft=levels[i].time;
  bgImg.src=levels[i].bg;
  music.src=levels[i].music;
  music.play();
  spawn();
  document.getElementById("start").style.display="none";
  document.getElementById("levelSelect").style.display="none";
  document.getElementById("gameOver").style.display="none";
  loop();
}

function gameOver(win){
  music.pause();
  let score=win?Math.floor(timeLeft*5432):0;
  document.getElementById("result").innerHTML=win?`Level ${currentLevel+1} Complete!<br>${levels[currentLevel].name}`:"Time Out!";
  document.getElementById("scoreText").textContent=win?`Score: ${score.toLocaleString()} points`:"";
  if(win && currentLevel+1>unlocked){
    unlocked=currentLevel+1;
    localStorage.setItem("xmas2025",unlocked);
  }
  document.getElementById("gameOver").style.display="flex";
}

function showLevelSelect(){
  document.getElementById("start").style.display="none";
  let sel=document.getElementById("levelSelect");
  sel.innerHTML=`<h1 style="font-size:48px;margin:30px">Choose Level</h1>
    <div style="display:grid;grid-template-columns:repeat(auto-fit,minmax(170px,1fr));gap:15px;max-width:1000px;padding:20px;overflow-y:auto"></div>
    <button onclick="location.reload()" style="margin-top:20px">Back</button>`;
  let grid=sel.querySelector("div");
  levels.forEach((lvl,i)=>{
    let card=document.createElement("div");
    card.className="card"+(i>unlocked?" locked":"");
    card.innerHTML=`<div style="font-size:44px;font-weight:bold">${i+1}</div><div style="font-size:18px">${lvl.name}</div><small>${lvl.time}s • ${lvl.grinches} Grinches</small>`;
    card.onclick=()=>startLevel(i);
    grid.appendChild(card);
  });
  sel.style.display="flex";
}

function shareResult(){
  let score=Math.floor(timeLeft*5432);
  let text=`I crushed Level ${currentLevel+1} — ${levels[currentLevel].name} — ${score.toLocaleString()} points! Christmas Gift Hunt 2025`;
  if(navigator.share) navigator.share({title:"Christmas Gift Hunt",text:text,url:location.href});
  else {navigator.clipboard.writeText(text+" "+location.href); alert("Copied to clipboard!");}
}

// THIS LINE MAKES THE PLAY BUTTON WORK
document.getElementById("playBtn").onclick = showLevelSelect;
</script>
</body>
</html>
